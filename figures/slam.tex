\documentclass[11pt]{article}
\input shared.texm
\def\graybg{lightgray}

%circle of a given color with text
\def\NODE(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=#4](#1,#2){0.27}{#3}\rput(#1,#2){#5}}%
%silen state
\def\SNODE(#1,#2)#3#4{%
\cnode[fillstyle=solid,fillcolor=#4](#1,#2){0.1}{#3}}%

\def\BlackNode(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=gray](#1,#2){#3}{#4}\rput(#1,#2){\textcolor{white}{#5}}}%

\def\WhiteNode(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=white](#1,#2){#3}{#4}\rput(#1,#2){\textcolor{black}{#5}}}%

\def\BNODE(#1,#2)#3#4#5{%
\fnode[linecolor=#4,fillstyle=solid,fillcolor=#4,framesize=0.5](#1,#2){#3}\rput(#1,#2){#5}}%

%centered text in a box of given size
\def\centeredtext#1#2{%
\begin{minipage}{#1}\begin{centering}%
#2%
\end{centering}\end{minipage}}

\startfile
\psset{unit=1.5cm}%
\psset{linewidth=0.7pt}%
\psset{arrowsize=1.8pt 4}%
\begin{pspicture}(-4,-0.75)(4.2,5.3)
\psset{arrows=->}
\def\xa{1.1}
\def\xb{2.2}
\def\xc{3.3}
\def\xd{4}


\BlackNode(0,0){0.74}{intergenic}{$Intergene$}

\WhiteNode(0,1.5){0.27}{ESING}{$E_{I,F}$}
\ncarc[angle=-90]{intergenic}{ESING}
\ncarc[angle=-90]{ESING}{intergenic}

\WhiteNode(-4,1.5){0.27}{EI0}{$E_{I,0}$}
\ncline[angle=-90]{intergenic}{EI0}
\WhiteNode(-3,1.5){0.27}{EI1}{$E_{I,1}$}
\ncline[angle=-90]{intergenic}{EI1}
\WhiteNode(-2,1.5){0.27}{EI2}{$E_{I,2}$}
\ncline[angle=-90]{intergenic}{EI2}

\WhiteNode(2,1.5){0.27}{E0F}{$E_{0,F}$}
\ncline[angle=180]{intergenic}{E0F}
\WhiteNode(3,1.5){0.27}{E1F}{$E_{1,F}$}
\ncline[angle=90]{intergenic}{E1F}
\WhiteNode(4,1.5){0.27}{E2F}{$E_{2,F}$}
\ncline[angle=90]{intergenic}{E2F}


\BlackNode(-3,3){0.55}{INTRON0}{$Intron_0$}
\BlackNode(0,3){0.55}{INTRON1}{$Intron_1$}
\BlackNode(3,3){0.55}{INTRON2}{$Intron_2$}

\ncline{EI0}{INTRON0}
\ncline{EI1}{INTRON1}
\ncline{EI2}{INTRON2}

\ncline{INTRON0}{E0F}
\ncline{INTRON1}{E1F}
\ncline{INTRON2}{E2F}

\WhiteNode(-4,4.5){0.27}{E00}{$E_{0,0}$}
\WhiteNode(-3,4.5){0.27}{E01}{$E_{0,1}$}
\WhiteNode(-2,4.5){0.27}{E02}{$E_{0,2}$}

\WhiteNode(-1,5){0.27}{E10}{$E_{1,0}$}
\WhiteNode(0,5){0.27}{E11}{$E_{1,1}$}
\WhiteNode(1,5){0.27}{E12}{$E_{1,2}$}

\WhiteNode(2,4.5){0.27}{E20}{$E_{2,0}$}
\WhiteNode(3,4.5){0.27}{E21}{$E_{2,1}$}
\WhiteNode(4,4.5){0.27}{E22}{$E_{2,2}$}

\ncarc{INTRON0}{E00}
\ncline{INTRON0}{E01}
\ncline{INTRON0}{E02}
\ncarc{E00}{INTRON0}
\ncline{E10}{INTRON0}
\ncline{E20}{INTRON0}

\ncline{INTRON1}{E10}
\ncarc{INTRON1}{E11}
\ncline{INTRON1}{E12}
\ncline{E01}{INTRON1}
\ncarc{E11}{INTRON1}
\ncline{E21}{INTRON1}

\ncline{INTRON2}{E20}
\ncline{INTRON2}{E21}
\ncarc{INTRON2}{E22}
\ncline{E02}{INTRON2}
\ncline{E12}{INTRON2}
\ncarc{E22}{INTRON2}

%\NODE(1,0){match}{white}{$M$}
%\BNODE(1,-1){ematch}{white}{$\Sigma\times\Sigma$}
%\ncline{match}{ematch}

%\NODE(3,-0.5){insertX}{white}{$I_X$}
%\BNODE(3,-1.5){einsertX}{white}{$\Sigma\times\{-\}$}
%\ncline{insertX}{einsertX}

%\NODE(-1,-0.5){insertY}{white}{$I_Y$}
%\BNODE(-1,-1.5){einsertY}{white}{$\{-\}\times\Sigma$}
%\ncline{insertY}{einsertY}

%\ncarc[angle=-90]{match}{insertX}\aput[0.02]{0}{$0.01$}
%\ncarc[angle=-90]{insertX}{match}\aput[0.02]{0}{$0.08$}

%\ncarc[angle=-90]{match}{insertY}\aput[0.02]{0}{$0.01$}
%\ncarc[angle=-90]{insertY}{match}\aput[0.02]{0}{$0.08$}

%\nccircle[angle=0]{match}{0.27}\bput[0.02]{0}{$0.98$}
%\nccircle[angle=-45]{insertX}{0.27}\bput[0.02]{0}{$0.92$}
%\nccircle[angle=45]{insertY}{0.27}\bput[0.02]{0}{$0.92$}

%
%\ncline{start}{bstart}
%\ncline{bstart}{hash}
%\ncline{hash}{bfinal}
%\ncline{bfinal}{final}
%
%\nccircle[angle=0]{start}{0.27}\bput[0.02]{0}{}
%\nccircle[angle=0]{final}{0.27}\bput[0.02]{0}{}
%
%\NODE(-1,-1){0}{white}{$0$}
%\BNODE(-1,-2){e0}{white}{$\{0,?\}$}
%\ncline{0}{e0}
%
%\NODE(1,-1){1}{white}{$1$}
%\BNODE(1,-2){e1}{white}{$\{1,?\}$}
%\ncline{1}{e1}
%
%
%\ncline{hash}{0}
%\ncline{0}{hash}
%\ncline{hash}{1}
%\ncline{1}{hash}
%
%\ncline{final}{error}

\end{pspicture}
\endfile

