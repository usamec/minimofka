\documentclass[11pt]{article}
\input shared.texm
\def\graybg{lightgray}

%circle of a given color with text
\def\NODE(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=#4](#1,#2){0.23}{#3}\rput(#1,#2){#5}}%
%silen state
\def\SNODE(#1,#2)#3#4{%
\cnode[fillstyle=solid,fillcolor=#4](#1,#2){0.1}{#3}}%

\def\BNODE(#1,#2)#3#4#5{%
\fnode[linecolor=#4,fillstyle=solid,fillcolor=#4,framesize=0.5](#1,#2){#3}\rput(#1,#2){#5}}%

%centered text in a box of given size
\def\centeredtext#1#2{%
\begin{minipage}{#1}\begin{centering}%
#2%
\end{centering}\end{minipage}}

\startfile
\psset{unit=1.5cm}%
\psset{linewidth=0.7pt}%
\psset{arrowsize=1.8pt 4}%
\begin{pspicture}(-1,-1.8)(1.25,1.8)
\psset{arrows=->}
\def\xa{1.1}
\def\xb{2.2}
\def\xc{3.3}
\def\xd{4}

\NODE(-1,0){start}{gray}{$M$}
\NODE(0,1){I1}{white}{$I_1$}
\NODE(0,-1){I2}{white}{$I_2$}
\ncarc{start}{I1}\aput[0.02]{0}{$a_1$}
\ncarc{start}{I2}\aput[0.02]{0}{$a_2$}
\ncarc{I1}{start}\aput[0.02]{0}{$1-p_1$}
\ncarc{I2}{start}\aput[0.02]{0}{$1-p_2$}
\nccircle[angle=0]{I1}{0.23}\bput[0.02]{0}{$p_1$}
\nccircle[angle=180]{I2}{0.23}\bput[0.02]{0}{$p_2$}

%\NODE(1,0){match}{white}{$M$}
%\BNODE(1,-1){ematch}{white}{$\Sigma\times\Sigma$}
%\ncline{match}{ematch}
%
%\NODE(2,-0.5){insertX}{white}{$I_X$}
%\BNODE(2,-1.5){einsertX}{white}{$\Sigma\times\{-\}$}
%\ncline{insertX}{einsertX}
%
%\NODE(0,-0.5){insertY}{white}{$I_Y$}
%\BNODE(0,-1.5){einsertY}{white}{$\{-\}\times\Sigma$}
%\ncline{insertY}{einsertY}
%
%\ncarc[angle=-90]{match}{insertX}
%\ncarc[angle=-90]{insertX}{match}
%
%\ncarc[angle=-90]{match}{insertY}
%\ncarc[angle=-90]{insertY}{match}
%
%\nccircle[angle=0]{match}{0.23}\bput[0.02]{0}{$e_{M,M}$}
%\nccircle[angle=-45]{insertX}{0.23}\bput[0.02]{0}{$e_{I,I}$}
%\nccircle[angle=45]{insertY}{0.23}\bput[0.02]{0}{$e_{I,I}$}
%
%
%\ncline{start}{bstart}
%\ncline{bstart}{hash}
%\ncline{hash}{bfinal}
%\ncline{bfinal}{final}
%
%\nccircle[angle=0]{start}{0.23}\bput[0.02]{0}{}
%\nccircle[angle=0]{final}{0.23}\bput[0.02]{0}{}
%
%\NODE(-1,-1){0}{white}{$0$}
%\BNODE(-1,-2){e0}{white}{$\{0,?\}$}
%\ncline{0}{e0}
%
%\NODE(1,-1){1}{white}{$1$}
%\BNODE(1,-2){e1}{white}{$\{1,?\}$}
%\ncline{1}{e1}
%
%
%\ncline{hash}{0}
%\ncline{0}{hash}
%\ncline{hash}{1}
%\ncline{1}{hash}
%
%\ncline{final}{error}

\end{pspicture}
\endfile

