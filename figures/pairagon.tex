\documentclass[11pt]{article}
\input shared.texm
\def\graybg{lightgray}

%circle of a given color with text
\def\NODE(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=#4](#1,#2){0.27}{#3}\rput(#1,#2){#5}}%
%silen state
\def\SNODE(#1,#2)#3#4{%
\cnode[fillstyle=solid,fillcolor=#4](#1,#2){0.1}{#3}}%

\def\BlackNode(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=gray](#1,#2){#3}{#4}\rput(#1,#2){\textcolor{white}{#5}}}%

\def\WhiteNode(#1,#2)#3#4#5{%
\cnode[fillstyle=solid,fillcolor=white](#1,#2){#3}{#4}\rput(#1,#2){\textcolor{black}{#5}}}%

\def\BNODE(#1,#2)#3#4#5{%
\fnode[linecolor=#4,fillstyle=solid,fillcolor=#4,framesize=0.5](#1,#2){#3}\rput(#1,#2){#5}}%

%centered text in a box of given size
\def\centeredtext#1#2{%
\begin{minipage}{#1}\begin{centering}%
#2%
\end{centering}\end{minipage}}

\startfile
\psset{unit=1.5cm}%
\psset{linewidth=0.7pt}%
\psset{arrowsize=1.8pt 4}%
\begin{pspicture}(-1.5,-1.3)(2.2,1.3)
\psset{arrows=->}
\def\xa{1.1}
\def\xb{2.2}
\def\xc{3.3}
\def\xd{4}


\BlackNode(0,0.5){0.23}{match}{$M$}
\BlackNode(1,1){0.23}{cDNAins}{$I_{c}$}
\BlackNode(1,0){0.23}{DNAins}{$I_{g}$}

\ncarc{match}{cDNAins}
\ncarc{match}{DNAins}
\ncarc{cDNAins}{match}
\ncarc{DNAins}{match}

\WhiteNode(-1,1){0.23}{noalnDNA}{$I^1_{g}$}
\WhiteNode(-1,0){0.23}{noalncDNA}{$I^1_{c}$}
\WhiteNode(2,0.9){0.23}{noalnDNA2}{$I^2_{g}$}
\WhiteNode(2,0.1){0.23}{noalncDNA2}{$I^2_{c}$}
\ncline{noalnDNA}{match}
\ncline{noalncDNA}{match}
\ncline{noalnDNA}{noalncDNA}
\ncline{match}{noalnDNA2}
\ncline{match}{noalncDNA2}
\ncline{noalnDNA2}{noalncDNA2}


\WhiteNode(-1.5,-0.75){0.23}{donor}{$D$}
\WhiteNode(-0.75,-0.85){0.23}{intron}{$In$}
\WhiteNode(0,-0.85){0.23}{branch}{$B$}
\WhiteNode(0.75,-0.85){0.23}{branchacc}{$BA$}
\WhiteNode(1.5,-0.75){0.23}{acceptor}{$A$}
\ncline{donor}{intron}
\ncline{intron}{branch}
\ncline{branch}{branchacc}
\ncline{branchacc}{acceptor}

\ncline{match}{donor}
\ncline[angle=90]{DNAins}{donor}

\ncline{acceptor}{match}
\ncline{acceptor}{cDNAins}

%\NODE(1,0){match}{white}{$M$}
%\BNODE(1,-1){ematch}{white}{$\Sigma\times\Sigma$}
%\ncline{match}{ematch}

%\NODE(3,-0.5){insertX}{white}{$I_X$}
%\BNODE(3,-1.5){einsertX}{white}{$\Sigma\times\{-\}$}
%\ncline{insertX}{einsertX}

%\NODE(-1,-0.5){insertY}{white}{$I_Y$}
%\BNODE(-1,-1.5){einsertY}{white}{$\{-\}\times\Sigma$}
%\ncline{insertY}{einsertY}

%\ncarc[angle=-90]{match}{insertX}\aput[0.02]{0}{$0.01$}
%\ncarc[angle=-90]{insertX}{match}\aput[0.02]{0}{$0.08$}

%\ncarc[angle=-90]{match}{insertY}\aput[0.02]{0}{$0.01$}
%\ncarc[angle=-90]{insertY}{match}\aput[0.02]{0}{$0.08$}

%\nccircle[angle=0]{match}{0.27}\bput[0.02]{0}{$0.98$}
%\nccircle[angle=-45]{insertX}{0.27}\bput[0.02]{0}{$0.92$}
%\nccircle[angle=45]{insertY}{0.27}\bput[0.02]{0}{$0.92$}

%
%\ncline{start}{bstart}
%\ncline{bstart}{hash}
%\ncline{hash}{bfinal}
%\ncline{bfinal}{final}
%
%\nccircle[angle=0]{start}{0.27}\bput[0.02]{0}{}
%\nccircle[angle=0]{final}{0.27}\bput[0.02]{0}{}
%
%\NODE(-1,-1){0}{white}{$0$}
%\BNODE(-1,-2){e0}{white}{$\{0,?\}$}
%\ncline{0}{e0}
%
%\NODE(1,-1){1}{white}{$1$}
%\BNODE(1,-2){e1}{white}{$\{1,?\}$}
%\ncline{1}{e1}
%
%
%\ncline{hash}{0}
%\ncline{0}{hash}
%\ncline{hash}{1}
%\ncline{1}{hash}
%
%\ncline{final}{error}

\end{pspicture}
\endfile

